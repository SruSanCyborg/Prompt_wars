<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBSCURA - Reality Distortion Detector</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #0a0a0a;
            --darker-bg: #050505;
            --primary: #8a2be2;
            --primary-glow: #a347ff;
            --secondary: #00ffea;
            --secondary-glow: #00c4b3;
            --danger: #ff2a6d;
            --danger-glow: #ff4d85;
            --warning: #ffcc00;
            --text: #e0e0e0;
            --text-dim: #a0a0a0;
            --panel-bg: rgba(20, 20, 30, 0.7);
            --glow: 0 0 10px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text);
            font-family: 'Exo 2', sans-serif;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(138, 43, 226, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 255, 234, 0.1) 0%, transparent 20%),
                linear-gradient(to bottom, var(--darker-bg), #0f0f1a);
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    0deg,
                    rgba(20, 20, 30, 0.2),
                    rgba(20, 20, 30, 0.2) 1px,
                    transparent 1px,
                    transparent 2px
                );
            pointer-events: none;
            z-index: -1;
        }
        
        .cyberpunk-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header Styles */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
            margin-bottom: 3rem;
            position: relative;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            color: var(--primary);
            text-shadow: var(--glow) var(--primary-glow);
        }
        
        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 2.2rem;
            letter-spacing: 3px;
            text-transform: uppercase;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
        }
        
        .tagline {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: var(--text-dim);
            text-align: center;
            margin-top: 0.5rem;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        /* Main Content */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .panel {
            background: var(--panel-bg);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.3);
        }
        
        .panel-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            margin-bottom: 1.5rem;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .panel-title i {
            color: var(--primary);
        }
        
        /* Text Input Area */
        .input-area {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .dropzone {
            background: rgba(10, 10, 15, 0.7);
            border: 2px dashed rgba(138, 43, 226, 0.5);
            border-radius: 6px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .dropzone:hover, .dropzone.active {
            border-color: var(--primary-glow);
            background: rgba(138, 43, 226, 0.1);
        }
        
        .dropzone i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .image-preview {
            margin-top: 1.5rem;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid rgba(138, 43, 226, 0.3);
            max-height: 300px;
        }
        
        .image-preview img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .input-controls {
            display: flex;
            justify-content: space-between;
        }
        
        .btn {
            background: rgba(138, 43, 226, 0.2);
            color: var(--text);
            border: 1px solid var(--primary);
            border-radius: 4px;
            padding: 0.8rem 1.5rem;
            font-family: 'Orbitron', sans-serif;
            font-weight: 500;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        
        .btn:hover {
            background: rgba(138, 43, 226, 0.4);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.4);
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--primary), #6a11cb);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, var(--primary-glow), #7a1bdb);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.6);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Analysis Results */
        .results-area {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .analysis-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .metric-card {
            background: rgba(10, 10, 15, 0.5);
            border: 1px solid;
            border-radius: 6px;
            padding: 1.2rem;
            text-align: center;
        }
        
        .metric-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            margin: 0.5rem 0;
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .manipulation {
            border-color: var(--danger);
            box-shadow: 0 0 10px rgba(255, 42, 109, 0.2);
        }
        
        .emotional {
            border-color: var(--warning);
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.2);
        }
        
        .political {
            border-color: var(--primary);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.2);
        }
        
        .inconsistencies {
            border-color: var(--secondary);
            box-shadow: 0 0 10px rgba(0, 255, 234, 0.2);
        }
        
        .analysis-details {
            background: rgba(10, 10, 15, 0.7);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: 6px;
            padding: 1.2rem;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .detail-item {
            padding: 0.8rem;
            margin-bottom: 0.8rem;
            border-left: 3px solid;
            background: rgba(20, 20, 30, 0.5);
        }
        
        .detail-item.manipulation {
            border-left-color: var(--danger);
        }
        
        .detail-item.emotional {
            border-left-color: var(--warning);
        }
        
        .detail-item.political {
            border-left-color: var(--primary);
        }
        
        .detail-item.inconsistency {
            border-left-color: var(--secondary);
        }
        
        .detail-item .label {
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .progress-area {
            margin: 1.5rem 0;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Scan Animation */
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--secondary), transparent);
            box-shadow: 0 0 10px var(--secondary-glow);
            animation: scan 4s linear infinite;
            z-index: 10;
        }
        
        @keyframes scan {
            0% {
                top: 0;
            }
            100% {
                top: 100%;
            }
        }
        
        .extracted-text {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: 6px;
            padding: 1rem;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        /* AI Insight Section */
        .insight-section {
            background: rgba(10, 10, 15, 0.7);
            border: 1px solid rgba(255, 42, 109, 0.3);
            border-radius: 6px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .insight-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--danger);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        
        .insight-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .insight-card {
            background: rgba(20, 0, 10, 0.5);
            border: 1px solid var(--danger);
            border-radius: 6px;
            padding: 1rem;
        }
        
        .insight-card h4 {
            color: var(--danger-glow);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .insight-list {
            list-style: none;
            padding-left: 0;
        }
        
        .insight-list li {
            padding: 0.4rem 0;
            border-bottom: 1px solid rgba(255, 42, 109, 0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .insight-list li:last-child {
            border-bottom: none;
        }
        
        .insight-list li i {
            color: var(--danger);
        }
        
        /* Highlighted text */
        .highlighted-text {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 234, 0.3);
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .highlighted-text span {
            position: relative;
            cursor: help;
        }
        
        .highlighted-text .trigger-manipulation {
            background-color: rgba(255, 42, 109, 0.3);
            border-bottom: 1px dashed var(--danger);
        }
        
        .highlighted-text .trigger-emotional {
            background-color: rgba(255, 204, 0, 0.3);
            border-bottom: 1px dashed var(--warning);
        }
        
        .highlighted-text .trigger-political {
            background-color: rgba(138, 43, 226, 0.3);
            border-bottom: 1px dashed var(--primary);
        }
        
        .tooltip {
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 10, 15, 0.95);
            border: 1px solid var(--primary);
            color: var(--text);
            padding: 0.5rem;
            border-radius: 4px;
            white-space: nowrap;
            z-index: 100;
            display: none;
        }
        
        .highlighted-text span:hover .tooltip {
            display: block;
        }
        
        /* Emotional Temperature */
        .emotional-temperature {
            margin-top: 1.5rem;
        }
        
        .temp-meter {
            display: flex;
            height: 20px;
            background: linear-gradient(to right, var(--secondary), var(--warning), var(--danger));
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .temp-pointer {
            position: absolute;
            top: -5px;
            width: 3px;
            height: 30px;
            background: white;
            transform: translateX(-50%);
            box-shadow: 0 0 10px white;
        }
        
        .temp-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            color: var(--text-dim);
            font-size: 0.9rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 0;
            color: var(--text-dim);
            font-size: 0.9rem;
            border-top: 1px solid rgba(138, 43, 226, 0.2);
            margin-top: 2rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .footer-links a {
            color: var(--text-dim);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--secondary);
        }
        
        /* Glitch Effect */
        .glitch {
            position: relative;
        }
        
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .glitch::before {
            left: 2px;
            text-shadow: -1px 0 red;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        
        .glitch::after {
            left: -2px;
            text-shadow: -1px 0 blue;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        
        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            10% { clip: rect(48px, 9999px, 29px, 0); }
            15% { clip: rect(42px, 9999px, 73px, 0); }
            20% { clip: rect(63px, 9999px, 27px, 0); }
            25% { clip: rect(34px, 9999px, 55px, 0); }
            30% { clip: rect(86px, 9999px, 73px, 0); }
            35% { clip: rect(20px, 9999px, 20px, 0); }
            40% { clip: rect(26px, 9999px, 60px, 0); }
            45% { clip: rect(25px, 9999px, 66px, 0); }
            50% { clip: rect(57px, 9999px, 98px, 0); }
            55% { clip: rect(5px, 9999px, 46px, 0); }
            60% { clip: rect(82px, 9999px, 31px, 0); }
            65% { clip: rect(54px, 9999px, 27px, 0); }
            70% { clip: rect(28px, 9999px, 99px, 0); }
            75% { clip: rect(45px, 9999px, 69px, 0); }
            80% { clip: rect(23px, 9999px, 85px, 0); }
            85% { clip: rect(54px, 9999px, 84px, 0); }
            90% { clip: rect(45px, 9999px, 47px, 0); }
            95% { clip: rect(37px, 9999px, 40px, 0); }
            100% { clip: rect(73px, 9999px, 99px, 0); }
        }
        
        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            5% { clip: rect(52px, 9999px, 74px, 0); }
            10% { clip: rect(79px, 9999px, 85px, 0); }
            15% { clip: rect(75px, 9999px, 5px, 0); }
            20% { clip: rect(67px, 9999px, 61px, 0); }
            25% { clip: rect(14px, 9999px, 79px, 0); }
            30% { clip: rect(1px, 9999px, 66px, 0); }
            35% { clip: rect(86px, 9999px, 30px, 0); }
            40% { clip: rect(23px, 9999px, 98px, 0); }
            45% { clip: rect(85px, 9999px, 72px, 0); }
            50% { clip: rect(71px, 9999px, 75px, 0); }
            55% { clip: rect(2px, 9999px, 48px, 0); }
            60% { clip: rect(30px, 9999px, 16px, 0); }
            65% { clip: rect(59px, 9999px, 50px, 0); }
            70% { clip: rect(41px, 9999px, 62px, 0); }
            75% { clip: rect(2px, 9999px, 82px, 0); }
            80% { clip: rect(47px, 9999px, 73px, 0); }
            85% { clip: rect(3px, 9999px, 27px, 0); }
            90% { clip: rect(26px, 9999px, 55px, 0); }
            95% { clip: rect(42px, 9999px, 97px, 0); }
            100% { clip: rect(38px, 9999px, 49px, 0); }
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .analysis-summary {
                grid-template-columns: 1fr;
            }
            
            .insight-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="scan-line"></div>
    
    <div class="cyberpunk-container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-eye"></i>
                </div>
                <div>
                    <div class="logo-text">OBSCURA</div>
                    <div class="tagline">Reality Distortion Detector</div>
                </div>
            </div>
            <button class="btn"><i class="fas fa-cog"></i> Settings</button>
        </header>
        
        <main>
            <div class="dashboard">
                <div class="panel input-area">
                    <h2 class="panel-title"><i class="fas fa-search"></i> TruthLens Scanner</h2>
                    
                    <div class="dropzone" id="dropzone">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drag & drop an image here or click to select</p>
                        <p class="small">(Screenshots, social media posts, news images)</p>
                    </div>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    
                    <div id="imagePreview" class="image-preview" style="display: none;">
                        <img id="previewImage" src="" alt="Preview">
                    </div>
                    
                    <div class="input-controls">
                        <button class="btn" id="clearBtn"><i class="fas fa-history"></i> Clear</button>
                        <button id="analyzeBtn" class="btn btn-primary" disabled><i class="fas fa-bolt"></i> Analyze Reality</button>
                    </div>
                    
                    <div class="progress-area" style="display: none;" id="progressContainer">
                        <div class="progress-label">
                            <span>Processing</span>
                            <span id="progressLabel">Initializing...</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    
                    <div id="extractedTextContainer" style="display: none;">
                        <h3 class="panel-title"><i class="fas fa-font"></i> Extracted Text</h3>
                        <div class="extracted-text" id="extractedText"></div>
                    </div>
                </div>
                
                <div class="panel results-area">
                    <h2 class="panel-title"><i class="fas fa-chart-network"></i> Distortion Analysis</h2>
                    <div class="analysis-summary">
                        <div class="metric-card manipulation">
                            <div class="metric-value" id="manipulationValue">0%</div>
                            <div class="metric-label">Manipulation Detected</div>
                        </div>
                        <div class="metric-card emotional">
                            <div class="metric-value" id="emotionalValue">0%</div>
                            <div class="metric-label">Emotional Bait</div>
                        </div>
                        <div class="metric-card political">
                            <div class="metric-value" id="politicalValue">0%</div>
                            <div class="metric-label">Political Framing</div>
                        </div>
                        <div class="metric-card inconsistencies">
                            <div class="metric-value" id="inconsistenciesValue">0</div>
                            <div class="metric-label">Logical Inconsistencies</div>
                        </div>
                    </div>
                    <h3 class="panel-title"><i class="fas fa-list"></i> Critical Findings</h3>
                    <div class="analysis-details" id="analysisDetails">
                        <div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Upload an image to detect reality distortions</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-brain"></i> Cognitive Analysis</h2>
                <div class="cognitive-insights" id="cognitiveInsights">
                    <div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                        <i class="fas fa-lightbulb" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Analysis will reveal psychological techniques and countermeasures</p>
                    </div>
                </div>
                
                <div class="insight-section">
                    <h3 class="insight-title"><i class="fas fa-code"></i> AI Insight Summary</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4><i class="fas fa-exclamation-triangle"></i> Manipulation Detected</h4>
                            <ul class="insight-list" id="manipulationList">
                                <li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4><i class="fas fa-lightbulb"></i> Psychological Analysis</h4>
                            <ul class="insight-list" id="psychologyList">
                                <li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-highlighter"></i> TruthLens Breakdown</h2>
                <div class="highlighted-text" id="highlightedText">
                    <p>Upload an image to see trigger word analysis...</p>
                </div>
                
                <h3 class="panel-title" style="margin-top: 1.5rem;"><i class="fas fa-thermometer-half"></i> Emotional Temperature</h3>
                <div class="emotional-temperature">
                    <div class="temp-meter">
                        <div class="temp-pointer" id="tempPointer" style="left: 20%;"></div>
                    </div>
                    <div class="temp-labels">
                        <span>Low</span>
                        <span>Moderate</span>
                        <span>High</span>
                        <span>Extreme</span>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <p>OBSCURA v1.0 - Reality Distortion Detection System</p>
            <p class="glitch" data-text="In a world ruled by illusions, power lies in seeing the unseen.">In a world ruled by illusions, power lies in seeing the unseen.</p>
            <div class="footer-links">
                <a href="#"><i class="fab fa-github"></i> GitHub</a>
                <a href="#"><i class="fas fa-book"></i> Documentation</a>
                <a href="#"><i class="fas fa-envelope"></i> Contact</a>
                <a href="#"><i class="fas fa-shield-alt"></i> Privacy</a>
            </div>
        </footer>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropzone = document.getElementById('dropzone');
            const fileInput = document.getElementById('fileInput');
            const previewImage = document.getElementById('previewImage');
            const imagePreview = document.getElementById('imagePreview');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const clearBtn = document.getElementById('clearBtn');
            const progressContainer = document.getElementById('progressContainer');
            const progressLabel = document.getElementById('progressLabel');
            const progressFill = document.getElementById('progressFill');
            const extractedText = document.getElementById('extractedText');
            const extractedTextContainer = document.getElementById('extractedTextContainer');
            const analysisDetails = document.getElementById('analysisDetails');
            const cognitiveInsights = document.getElementById('cognitiveInsights');
            const manipulationList = document.getElementById('manipulationList');
            const psychologyList = document.getElementById('psychologyList');
            const highlightedText = document.getElementById('highlightedText');
            const tempPointer = document.getElementById('tempPointer');
            
            // Hardcoded API key
            const API_KEY = 'your-api-key';
            
            // Metric elements
            const manipulationValue = document.getElementById('manipulationValue');
            const emotionalValue = document.getElementById('emotionalValue');
            const politicalValue = document.getElementById('politicalValue');
            const inconsistenciesValue = document.getElementById('inconsistenciesValue');
            
            let currentImageData = null;
            
            // Set up dropzone functionality
            dropzone.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files && e.target.files[0]) {
                    loadImage(e.target.files[0]);
                }
            });
            
            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('active');
            });
            
            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('active');
            });
            
            dropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropzone.classList.remove('active');
                
                if (e.dataTransfer.files && e.dataTransfer.files[0]) {
                    loadImage(e.dataTransfer.files[0]);
                }
            });
            
            function loadImage(file) {
                if (!file.type.match('image.*')) {
                    alert('Please select an image file');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    currentImageData = e.target.result;
                    previewImage.src = currentImageData;
                    imagePreview.style.display = 'block';
                    analyzeBtn.disabled = false;
                    
                    // Hide previous results
                    extractedTextContainer.style.display = 'none';
                    progressContainer.style.display = 'none';
                    analysisDetails.innerHTML = `<div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Click "Analyze Reality" to detect distortions</p>
                    </div>`;
                    
                    cognitiveInsights.innerHTML = `<div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                        <i class="fas fa-lightbulb" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Analysis will reveal psychological techniques and countermeasures</p>
                    </div>`;
                    
                    highlightedText.innerHTML = `<p>Upload an image to see trigger word analysis...</p>`;
                    tempPointer.style.left = '20%';
                    
                    manipulationList.innerHTML = `<li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>`;
                    psychologyList.innerHTML = `<li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>`;
                    
                    // Reset metrics
                    manipulationValue.textContent = '0%';
                    emotionalValue.textContent = '0%';
                    politicalValue.textContent = '0%';
                    inconsistenciesValue.textContent = '0';
                };
                reader.readAsDataURL(file);
            }
            
            // Clear button functionality
            clearBtn.addEventListener('click', () => {
                fileInput.value = '';
                currentImageData = null;
                previewImage.src = '';
                imagePreview.style.display = 'none';
                analyzeBtn.disabled = true;
                extractedText.textContent = '';
                extractedTextContainer.style.display = 'none';
                progressContainer.style.display = 'none';
                
                analysisDetails.innerHTML = `<div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <p>Upload an image to detect reality distortions</p>
                </div>`;
                
                cognitiveInsights.innerHTML = `<div style="text-align: center; padding: 2rem; color: var(--text-dim);">
                    <i class="fas fa-lightbulb" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <p>Analysis will reveal psychological techniques and countermeasures</p>
                </div>`;
                
                highlightedText.innerHTML = `<p>Upload an image to see trigger word analysis...</p>`;
                tempPointer.style.left = '20%';
                
                manipulationList.innerHTML = `<li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>`;
                psychologyList.innerHTML = `<li><i class="fas fa-spinner fa-pulse"></i> Analyzing...</li>`;
                
                // Reset metrics
                manipulationValue.textContent = '0%';
                emotionalValue.textContent = '0%';
                politicalValue.textContent = '0%';
                inconsistenciesValue.textContent = '0';
            });
            
            // Set up analyze button
            analyzeBtn.addEventListener('click', () => {
                if (!currentImageData) return;
                
                // Show progress
                progressContainer.style.display = 'block';
                progressFill.style.width = '0%';
                progressLabel.textContent = 'Initializing...';
                
                // Perform OCR
                performOCR();
            });
            
            function performOCR() {
                Tesseract.recognize(
                    currentImageData,
                    'eng',
                    {
                        logger: progress => {
                            if (progress.status === 'recognizing text') {
                                progressLabel.textContent = `Processing: ${Math.round(progress.progress * 100)}%`;
                                progressFill.style.width = `${progress.progress * 100}%`;
                            } else {
                                progressLabel.textContent = progress.status;
                                if (progress.progress) {
                                    progressFill.style.width = `${progress.progress * 100}%`;
                                }
                            }
                        }
                    }
                ).then(({ data: { text } }) => {
                    extractedText.textContent = text;
                    extractedTextContainer.style.display = 'block';
                    
                    // Update progress
                    progressLabel.textContent = 'Analyzing content with AI...';
                    progressFill.style.width = '100%';
                    
                    // Analyze with Gemini API
                    analyzeWithGemini(text);
                }).catch(err => {
                    console.error(err);
                    progressLabel.textContent = 'Error processing image';
                });
            }
            
            function analyzeWithGemini(text) {
                // Prepare the prompt for Gemini
                const prompt = `
You are a Reality Distortion Detector. Analyze the following text for manipulation techniques, emotional bait, political framing, and logical inconsistencies.

Provide your analysis in the following JSON format:

{
  "distortion_analysis": {
    "manipulation_score": 0-100, // percentage score for manipulative language
    "emotional_bait_score": 0-100, // percentage score for emotional bait
    "political_framing_score": 0-100, // percentage score for political framing
    "logical_inconsistencies_count": 0 // integer count of logical inconsistencies
  },
  "critical_findings": [
    {
      "type": "manipulation | emotional | political | inconsistency",
      "label": "Short label for the finding",
      "description": "Detailed description of the finding"
    }
    // ... up to 4 findings
  ],
  "cognitive_analysis": {
    "psychological_techniques": [
      "List of detected psychological techniques (each as a string)"
    ],
    "countermeasures": [
      "List of recommended countermeasures (each as a string)"
    ]
  },
  "ai_insight_summary": {
    "manipulation_detected": [
      "List of specific manipulation techniques found (each as a string)"
    ],
    "psychological_analysis": [
      "List of psychological insights (each as a string)"
    ]
  },
  "truth_lens_breakdown": "HTML string with the original text where trigger words are highlighted with spans. Example: 'This <span class=\"trigger-manipulation\">shocking<span class=\"tooltip\">Designed to create strong emotional reaction</span></span> revelation ...'",
  "emotional_temperature": 0-100 // overall emotional intensity score
}

Now, analyze the following text:

${text.substring(0, 3000)} // Limit to 3000 characters for token constraints
`;

                // Call Gemini API with hardcoded API key
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
                const requestBody = {
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }]
                };
                
                fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-goog-api-key': API_KEY
                    },
                    body: JSON.stringify(requestBody)
                })
                .then(response => response.json())
                .then(data => {
                    // Hide progress
                    setTimeout(() => {
                        progressContainer.style.display = 'none';
                    }, 500);
                    
                    try {
                        // Extract the text from Gemini response
                        const responseText = data.candidates[0].content.parts[0].text;
                        
                        // Parse the JSON response
                        const startIndex = responseText.indexOf('{');
                        const endIndex = responseText.lastIndexOf('}');
                        const jsonText = responseText.substring(startIndex, endIndex + 1);
                        const analysis = JSON.parse(jsonText);
                        
                        // Update UI with analysis
                        updateAnalysisUI(analysis);
                    } catch (error) {
                        console.error('Error parsing Gemini response:', error);
                        progressLabel.textContent = 'Error parsing AI response';
                        simulateGeminiAnalysis(text); // Fallback to simulation
                    }
                })
                .catch(error => {
                    console.error('Gemini API Error:', error);
                    progressLabel.textContent = 'AI Analysis Failed';
                    simulateGeminiAnalysis(text); // Fallback to simulation
                });
            }
            
            function updateAnalysisUI(analysis) {
                // Update metrics
                manipulationValue.textContent = analysis.distortion_analysis.manipulation_score + '%';
                emotionalValue.textContent = analysis.distortion_analysis.emotional_bait_score + '%';
                politicalValue.textContent = analysis.distortion_analysis.political_framing_score + '%';
                inconsistenciesValue.textContent = analysis.distortion_analysis.logical_inconsistencies_count;
                
                // Update analysis details
                analysisDetails.innerHTML = '';
                
                analysis.critical_findings.forEach(item => {
                    const detailItem = document.createElement('div');
                    detailItem.className = `detail-item ${item.type}`;
                    detailItem.innerHTML = `
                        <div class="label"><i class="fas fa-${getIconForType(item.type)}"></i> ${item.label}</div>
                        <div class="description">${item.description}</div>
                    `;
                    analysisDetails.appendChild(detailItem);
                });
                
                // Update cognitive insights
                cognitiveInsights.innerHTML = `
                    <div class="insight">
                        <h4><i class="fas fa-lightbulb"></i> Psychological Techniques Detected:</h4>
                        <ul>
                            ${analysis.cognitive_analysis.psychological_techniques.map(tech => `<li><strong>${tech}</strong></li>`).join('')}
                        </ul>
                    </div>
                    <div class="insight">
                        <h4><i class="fas fa-shield-alt"></i> Recommended Countermeasures:</h4>
                        <ul>
                            ${analysis.cognitive_analysis.countermeasures.map(cm => `<li>${cm}</li>`).join('')}
                        </ul>
                    </div>
                `;
                
                // Update AI Insight Summary
                manipulationList.innerHTML = analysis.ai_insight_summary.manipulation_detected.map(item => 
                    `<li><i class="fas fa-hand-point-right"></i> ${item}</li>`
                ).join('');
                
                psychologyList.innerHTML = analysis.ai_insight_summary.psychological_analysis.map(item => 
                    `<li><i class="fas fa-brain"></i> ${item}</li>`
                ).join('');
                
                // Update highlighted text
                highlightedText.innerHTML = analysis.truth_lens_breakdown;
                
                // Update emotional temperature
                const intensity = analysis.emotional_temperature;
                tempPointer.style.left = `${intensity}%`;
            }
            
            function getIconForType(type) {
                switch(type) {
                    case 'manipulation': return 'exclamation-triangle';
                    case 'emotional': return 'heart-crack';
                    case 'political': return 'flag';
                    case 'inconsistency': return 'circle-exclamation';
                    default: return 'info-circle';
                }
            }
            
            // Fallback simulation if Gemini API fails
            function simulateGeminiAnalysis(text) {
                const isManipulative = text.toLowerCase().includes('shocking') || 
                                      text.toLowerCase().includes('hoax') || 
                                      text.toLowerCase().includes('must share');
                
                const isEmotional = text.toLowerCase().includes('urgent') || 
                                  text.toLowerCase().includes('freedom') || 
                                  text.toLowerCase().includes('danger');
                
                const hasPolitical = text.toLowerCase().includes('political') || 
                                  text.toLowerCase().includes('government') || 
                                  text.toLowerCase().includes('election');
                
                // Update metrics
                manipulationValue.textContent = isManipulative ? '92%' : '15%';
                emotionalValue.textContent = isEmotional ? '88%' : '22%';
                politicalValue.textContent = hasPolitical ? '76%' : '18%';
                inconsistenciesValue.textContent = isManipulative ? '3' : '1';
                
                // Update analysis details
                analysisDetails.innerHTML = '';
                
                const findings = [
                    {
                        type: 'manipulation',
                        label: 'Manipulative Language',
                        description: isManipulative 
                            ? 'Phrases designed to provoke strong reactions without evidence detected' 
                            : 'Minimal manipulative language detected',
                        icon: 'exclamation-triangle'
                    },
                    {
                        type: 'emotional',
                        label: 'Emotional Bait',
                        description: isEmotional 
                            ? 'Appeals to fear and urgency detected to bypass critical thinking' 
                            : 'Low emotional manipulation detected',
                        icon: 'heart-crack'
                    },
                    {
                        type: 'political',
                        label: 'Political Framing',
                        description: hasPolitical 
                            ? 'Content frames issues through a political lens rather than factual basis' 
                            : 'Minimal political framing detected',
                        icon: 'flag'
                    },
                    {
                        type: 'inconsistency',
                        label: 'Logical Inconsistency',
                        description: isManipulative 
                            ? 'Contradictory claims identified that undermine credibility' 
                            : 'No significant logical inconsistencies detected',
                        icon: 'circle-exclamation'
                    }
                ];
                
                findings.forEach(item => {
                    const detailItem = document.createElement('div');
                    detailItem.className = `detail-item ${item.type}`;
                    detailItem.innerHTML = `
                        <div class="label"><i class="fas fa-${item.icon}"></i> ${item.label}</div>
                        <div class="description">${item.description}</div>
                    `;
                    analysisDetails.appendChild(detailItem);
                });
                
                // Update cognitive insights
                cognitiveInsights.innerHTML = `
                    <div class="insight">
                        <h4><i class="fas fa-lightbulb"></i> Psychological Techniques Detected:</h4>
                        <ul>
                            <li><strong>${isEmotional ? 'Appeal to Emotion' : 'Minimal Emotional Manipulation'}</strong>: ${isEmotional ? 'Using alarming language to trigger emotional responses' : 'Content maintains relatively neutral tone'}</li>
                            <li><strong>${isManipulative ? 'False Urgency' : 'Standard Persuasion'}</strong>: ${isManipulative ? 'Creating artificial time pressure to prompt action' : 'No significant false urgency detected'}</li>
                            <li><strong>${text.toLowerCase().includes('us vs them') ? 'Tribal Framing' : 'Inclusive Language'}</strong>: ${text.toLowerCase().includes('us vs them') ? 'Dividing language that creates artificial groups' : 'Minimal divisive language detected'}</li>
                        </ul>
                    </div>
                    <div class="insight">
                        <h4><i class="fas fa-shield-alt"></i> Recommended Countermeasures:</h4>
                        <ul>
                            <li>Verify claims through multiple reputable sources</li>
                            <li>Consider the source's potential biases and motivations</li>
                            <li>Notice emotional triggers and separate from factual content</li>
                            <li>Look for original sources of any cited data or studies</li>
                            <li>Check dates and context - is this information current?</li>
                        </ul>
                    </div>
                `;
                
                // Update AI Insight Summary
                manipulationList.innerHTML = isManipulative ? `
                    <li><i class="fas fa-hand-point-right"></i> Guilt-tripping</li>
                    <li><i class="fas fa-hand-point-right"></i> Emotional invalidation</li>
                    <li><i class="fas fa-hand-point-right"></i> Victim-blaming</li>
                    <li><i class="fas fa-hand-point-right"></i> Gaslighting</li>
                ` : `
                    <li><i class="fas fa-check-circle"></i> Minimal manipulation detected</li>
                    <li><i class="fas fa-info-circle"></i> Standard persuasive techniques</li>
                `;
                
                psychologyList.innerHTML = `
                    <li><i class="fas fa-brain"></i> Instead of owning the impact of their actions, the author deflects, reverses blame, and shuts down dialogue</li>
                    <li><i class="fas fa-brain"></i> It doesn't tell you the truth  it shows how the illusion was built</li>
                    <li><i class="fas fa-brain"></i> Uses emotional triggers to bypass critical thinking</li>
                `;
                
                // Update highlighted text
                const sampleText = "This shocking revelation must be shared immediately! The government is hiding the truth about this dangerous situation. If you care about freedom, you'll act now before it's too late. They're trying to silence us and control the narrative.";
                
                highlightedText.innerHTML = `
                    <p>
                        This <span class="trigger-manipulation">shocking<span class="tooltip">Designed to create strong emotional reaction</span></span> 
                        revelation must be shared immediately! The 
                        <span class="trigger-political">government<span class="tooltip">Political framing to create opposition</span></span> 
                        is hiding the truth about this 
                        <span class="trigger-emotional">dangerous<span class="tooltip">Fear-inducing language</span></span> 
                        situation. If you care about 
                        <span class="trigger-emotional">freedom<span class="tooltip">Emotional trigger word</span></span>, 
                        you'll act now before it's too late. They're trying to 
                        <span class="trigger-manipulation">silence<span class="tooltip">Victim-blaming technique</span></span> 
                        us and control the narrative.
                    </p>
                `;
                
                // Update emotional temperature
                const intensity = isEmotional ? 85 : isManipulative ? 65 : 35;
                tempPointer.style.left = `${intensity}%`;
            }
        });
    </script>
</body>
</html>
